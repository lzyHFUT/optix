---
{"dg-publish":true,"dg-home":true,"permalink":"/机器学习的优化方法/机器学习的优化方法/","tags":["gardenEntry"],"dgPassFrontmatter":true,"created":"2025-04-23T20:18:55.520+08:00","updated":"2025-04-23T20:19:10.000+08:00"}
---

# 1. 求解Q收敛问题与共轭函数
## Q收敛
$x^*=\lim_{ k \to \infty }{x_{k}}$
考虑式：$$\lim_{ k \to \infty } \frac{{||x^{k+1}-x^*||}}{||x^{k}-x^*||}$$
若为0，则为Q-线性收敛，若为1，则为Q-超线性收敛，0~1之间为Q-次线性收敛
## e.g.
$x^k=\frac{1}{k!}$
$$x^*=0\implies \lim_{ k \to \infty } \frac{{||x^{k+1}-x^*||}}{x^{k}-x^*||}=0$$
$x^k = \begin{cases}\left( \frac{1}{4} \right)^{2^k}, & k=2n \\ \frac{x^{k-1}}{k}, & k=2n+1\end{cases}$
$$x^*=0\implies \lim_{ k \to \infty } \frac{{||x^{k+1}-x^*||}}{||x^{k}-x^*||}=0$$

## 共轭函数
$f^*(y)=\mathop{\sup}\limits_{x \in f}(<y,x>-f(x))$
## e.g.
$f(x)=x\ln x$
$$\begin{flalign}
yx-f(x)=yx-x\ln x\implies \frac{\partial(yx-f(x))}{\partial x}=y-\ln x-1=0\\
x=e^{y-1}\\
\implies f^*(y)=e^{y-1}
\end{flalign}
$$
$\Sigma^n_{i=1}x_{i}\ln x_{i}$
$$\begin{flalign}
yx-f(x)=\Sigma y_{i}x_{i}-\Sigma x_{i}\ln x_{i}\implies \frac{\partial(yx-f(x))}{\partial x}=\Sigma (y_{i}-\ln x-1)=0\\
x_{i}=e^{y_{i}-1}\\
\implies f^*(y)=\Sigma e^{y_{i}-1}
\end{flalign}
$$

# 2. 凸集证明
## 凸集
$f(x),f(y)\in C ,\theta \in (0,1),若f(\theta x+(1-\theta)y)\in C$则C为凸集
## 凸函数
$\nabla
{ #2f}
(x)\succeq{0}\implies f(\theta x+(1-\theta)y)\leq \theta f(x)+(1-\theta)f(y)$
## e.g.
$x^TAx+B^Tx+c\leq{0}$的解集为$C$，若$A$正定，求证$C$为凸集
$$\begin{flalign}
f(x)=x^TAx+B^Tx+c\leq{0}\\
\nabla^2 f(x)=2A^T\succeq0\implies f(\theta x+(1-\theta)y)\leq \theta f(x)+(1-\theta)f(y)\\
f(x)\leq 0,f(y)\leq 0\\
\implies f(\theta x+(1-\theta)y)\leq \theta f(x)+(1-\theta)f(y)\leq 0\implies C为凸集
\end{flalign}$$

# 3.矩阵分离问题
## 模型
$M$给定，将$M$分解为低秩矩阵$W$和稀疏矩阵$E\implies W+E=M$
非凸模型：$$\begin{flalign}
\mathop {min}\limits_{W,E\in R} rank(W)+\mu ||E||_{0}\\
s.t. W+E=M
\end{flalign}$$
凸松弛：$$\begin{flalign}
\mathop {min}\limits_{W,E} ||W||_{*}+\mu ||E||_{1}\\
s.t. W+E=M
\end{flalign}$$
## 应用
应用冲激噪声去除或者高光谱图像去噪，首先在图像上去除一个$q*q*B$的窗口，得到基于非凸模型，凸松弛后得对应的基于低秩正则化的优化模型，求解模型可以得到对应窗口内的干净图像矩阵。对整个图像范围内都进行这样的局部操作，即可对整个图像去噪
# 4. 对偶函数
## 等式约束
$$\begin{flalign}
\min x^Tx\\
s.t.Ax=b
\end{flalign}$$

$$\begin{flalign}
L(x,\nu)=x^Tx+\nu
{ #T}
(Ax-b)\\
由一阶条件：\nabla_{x}L(x,\nu)=2x+A^T\nu=0\implies x=\left( -\frac{1}{2} \right)A^T\nu\\
带入L：g(\nu)=-\frac{1}{4}\nu^TAA^T\nu-b^T\nu\\
因此对偶函数为：\max (-\frac{1}{4}\nu^TAA^T\nu-b^T\nu)
\end{flalign}$$
## 等式、不等式约束
$$\begin{flalign}
\min c^Tx\\
s.t.Ax=b\\
x\geq 0
\end{flalign}$$
$$\begin{flalign}
L(x,s,\nu)=c^Tx+\nu^T(Ax-b)-s^Tx\\
\nabla_{x}L=c+A^T\nu-s=0\\
带入L：g(s,\nu)=-\nu^Tb\implies g(s,\nu)=\begin{cases}-b^T\nu, & c+A^T\nu-s=0 \\ -\infty, & else\end{cases}\\
可得对偶问题：\mathop {\max} \limits_{s,\nu}-b^T\nu,\\
s.t.A^T\nu-s+c=0\\
s\geq 0
\end{flalign}$$
## 无约束问题
$$\begin{flalign}
\mathop{min}\limits_{x\in R} \frac{1}{2}||Ax-b||^2+\mu||x||_{1}\\
\end{flalign}$$
$$\begin{split}
令r=Ax-b,则原问题等价于\mathop{min}\limits_{x \in R} \frac{1}{2}||r||^2+\mu||x||_{1}，s.t.r=Ax-b\\
L(x,r,\lambda)=\frac{1}{2}||r||^2+\mu||x||_{1}-<\lambda,Ax-b-r>\\
\nabla_{r}L=0\\
L(x,r,\lambda)\implies||A^T\lambda||_{\infty}\leq \mu\\
带入L：g(\lambda)=\begin{cases}b^T\lambda-\frac{1}{2} ||\lambda||^2, & ||A^T\lambda||_{\infty}\leq \mu\\ -\infty, & else\end{cases}\\
可得对偶问题：\mathop {\max} \limits_{s,\nu}b^T\lambda-\frac{1}{2} ||\lambda||^2,\\
s.t.||A^T\lambda||_{\infty}\leq \mu
\end{split}$$
## e.g.
$$\begin{split}
\mathop {\min}\limits_{x \in R} ||x||_{1}\\
s.t. Ax=b
\end{split}$$
$$\begin{split}
L(x,\nu)=||x||_{1}+\nu^T(Ax-b)\\
\nabla_{x}L=0\implies||A^T\lambda||_{\infty}\leq 1\\
对偶问题：\max -b^T\lambda\\
s.t.||A^T\lambda||_{\infty}\leq 1
\end{split}$$
## KKT条件求解显式解
$$\begin{flalign}
\mathop{min}\limits_{x\in R} \frac{1}{2}||x-y||^2_{2}\\
s.t.Ax=b
\end{flalign}$$
$$\begin{split}
L(x,\lambda)=\frac{1}{2}||x-y||^2+\lambda^T(Ax-b)\\
x^*为全局最优解，则有\begin{cases}
x^*-y+A^T\lambda^*=0, \\
Ax^*=b.
\end{cases}\\
x^*=y-A^T(A^TA)^{-1}(Ay-b)
\end{split}$$
## e.g.
$$\begin{split}
||x||_{2}\\
s.t.Ax=b
\end{split}$$
$$\begin{split}
目标函数等价于 \frac{1}{2}||x||_{2}^2\\
L(x,\lambda)= \frac{1}{2}||x||_{2}^2+\lambda^T(Ax-b)\\
\nabla L_{x}(x^*,\lambda^*)=0\implies x^*+A^T\lambda^*=0\\
又有Ax^*=b\\
联立解得x^*=A^T(AA^T)^{-1}b
\end{split}$$
# 5.线搜索问题
## Armijo
$f(x^k+\alpha d^k)\leq f(x^k)+c_{1}\alpha \nabla f(x^k)^Td^k,c \in (0,1)$
![Pasted image 20250415203702.png|500](/img/user/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%9A%84%E4%BC%98%E5%8C%96%E6%96%B9%E6%B3%95/Pasted%20image%2020250415203702.png)
几何意义：点$(\alpha,\phi(\alpha))$始终在直线$l(\alpha)$的下方
缺陷：可能导致补偿$\alpha^k$过小
## Goldstein
改进思路：要求$(\alpha,\phi(\alpha))$不仅处于某条直线下方，还要求该点处于另一条直线上方
$$\begin{cases}
f(x^k+\alpha d^k)\leq f(x^k)+c\alpha \nabla f(x^k)^Td^k \\
f(x^k+\alpha d^k)\geq f(x^k)+(1-c)\alpha \nabla f(x^k)^Td^k
\end{cases},c\in\left( 0, \frac{1}{2} \right)$$
![Pasted image 20250415204443.png|500](/img/user/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%9A%84%E4%BC%98%E5%8C%96%E6%96%B9%E6%B3%95/Pasted%20image%2020250415204443.png)
缺点：可以使函数值充分下降，但是可能避开了最优的函数值
## Wolfe
改进思路：要求直线在$(\alpha,\phi(\alpha))$处的切线斜率不能小于$\phi'(0)$的$c_{2}$倍
优点：在极小值点$\alpha^*$处永远满足条件二
$$\begin{cases}
f(x^k+\alpha d^k)\leq f(x^k)+c\alpha \nabla f(x^k)^Td^k \\
\nabla f(x^k+\alpha d^k)^Td^k\geq c_{2}\nabla f(x^k)^Td^k
\end{cases},c_{1},c_{2}\in( 0, 1)\&c_{1}<c_{2}$$![Pasted image 20250415205336.png|500](/img/user/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%9A%84%E4%BC%98%E5%8C%96%E6%96%B9%E6%B3%95/Pasted%20image%2020250415205336.png)
# 6.牛顿法
- 梯度下降法：$x^{k+1}=x^k-\alpha_{k}\nabla f(x_{k})$
	- 缺点：只用到一阶信息，收敛速度缓慢
- 牛顿法：在$f(x)$足够光滑的情况下，使用二阶信息改进下降方向，加速算法的迭代：$x^{k+1}=x^k-\nabla f(x_{k})^-1\nabla
{ #2f}
(x_{k})$
	- 缺点：1. 计算存储代价昂贵 2. 海瑟矩阵非正定导致牛顿方向并非下降方向 3. 初始点离最优值点较远时导致迭代不稳定，算法不收敛
- 改进： 1. 修正使$\nabla^2 f(x)\succeq 0$ 2. 使用线搜索法确定步长提高稳定性

带线搜索的修正牛顿法：
- 给定初始点$x^0$
- **for**$\mu_{k}\geq \mu$**do**
	- 确定矩阵$E^k$使得矩阵$B^k\overset{\underset{\mathrm{def}}{}}{=}\nabla
{ #2f}
(x^k)+E^k$且正定条件数较小
	- 求解修正的牛顿方程$B^kd^k=-\nabla f(x^k)$得到方向$d^k$
	- 使用任意一种线搜索准则确定补偿$\alpha_{k}$
	- 更新$x^{k+1}=x^k+\alpha_{k}d^k$
-  **end for**
在计算大规模问题时，求解较为困难
解决方法：1. 不直接计算Hesse矩阵，近似得出 2. 不直接求近似矩阵的逆，通过代数结构计算 3. 近似矩阵及其逆保有Hesse矩阵的性质

拟牛顿法框架：
**Require**：初始坐标$x^0 \in R$，初始矩阵$B^0 \in R$(或$H^0$)，$k=0$
**Ensure**：$x^k,B^k$(或$H^k$).
- 检查初始元素
- **while**未达到停机准则前**do**
	- 计算方向$d^k=-(B^k)^{-1}\nabla f(x^k)$或$d^k=-H^k \nabla f(x^k)$
	- 通过线搜索(Wolfe)产生步长$\alpha_{k}>0$，令$x^{k+1}=x^k+\alpha_{k}d^k$
	- 更新Hesse矩阵的近似矩阵$B^{k+1}$或者其逆矩阵$H^{k+1}$
	-  $k\gets k+1$
- **end while**
# 7. 秩一更新、秩二更新
秩一更新：对于拟牛顿矩阵$B^k$，$u\ne {0}$，则$uu^T$为秩一更新矩阵，有秩一更新：$B^{k+1}=B^k+auu^T$
拟牛顿法的秩一更新公式：
$B^k:B^{k+1}=B^k+\frac{uu^T}{u^Ts^k} ,u=y^k-B^ks^k$
$H^k:H^{k+1}=H^k+\frac{\nu \nu^T}{\nu^Ty^k} ,\nu=s^k-H^ky^k$
缺点：无法保证$B^{k+1}$正定，即使$B^{k}$正定
$B^{k+1}$正定的充分条件：$B^{k}$正定且$u^Ts^k>0$

秩二更新：核心思想为对$B^k$进行秩二更新
对于拟牛顿矩阵$B^k$，有秩二更新：$B^{k+1}=B^k+auu^T+b\nu \nu^T$
$B^k:B^{k+1} = B^k + \frac{y^k (y^k)^T}{(s^k)^T y^k} - \frac{B^k s^k (B^k s^k)^T}{(s^k)^T B^k s^k}$
$H^k:H^{k+1} = \left( I - \frac{s^k (y^k)^T}{(s^k)^T y^k} \right)^T H^k \left( I - \frac{s^k (y^k)^T}{(s^k)^T y^k} \right) + \frac{s^k (s^k)^T}{(s^k)^T y^k}$
$B^{k+1}$正定的充分条件：$B^{k}$或$H^k$正定且满足曲率条件$(s^k)^Ty^k>0$
# 8.低秩矩阵恢复、增广拉格朗日函数
罚函数：$$\begin{split}
\mathop{\min }_{x}f(x)\\
s.t.c_{i}(x)=0\\
该问题的二次罚函数为：P_{E}(x, \sigma)=f(x)+\frac{1}{2} \sigma \Sigma c_{i}^2(x)
\end{split}$$
求解步骤
- 给定$\sigma_{1}>0,x^0,k \gets 1.$罚因子增长系数$\rho>1$
- **while**未达到收敛准则**do**
	- 以$x^k$为初始点，求解$x^{k+1}=\mathop {arg \min} \limits_{x}P_{E}(x,\sigma_{k})$
	- 选取$\sigma_{k+1}=\rho \sigma_{k}$
	- $k \gets k+1$
- **end while**
## LASSO问题
$$\begin{split}
\mathop {min}\limits_{x} \frac{1}{2}||Ax-b||^2+\mu||x||_{1}\\
BP问题：\min ||x||_{1}\\
s.t. Ax=b\\
写成二次罚函数\\
\mathop{\min}\limits_{x}||x||_{1}+\frac{\sigma}{2} ||Ax-b||^2
\end{split}$$
求解步骤
- 给定初值$X^0，最终参数\mu，初始参数\mu_{0}，因子\gamma \in (0,1),k\gets {0}$
- **while**$\mu_{k}\geq \mu$**do**
	- 以$X^k$为初值，$\mu=\mu_{k}$为正则化求解问题$x^{k+1}=\mathop{arg\min}\limits_{x} \frac{1}{2} ||Ax-b||+\mu_{k}||x||_{1}$
	- **if**$\mu_{k}=\mu$**then**
		- 停止迭代，输出$X^{k+{1}}$
	- **else**
		- 更新罚因子$\mu_{k+1}=\max \left\{ \mu,\gamma \mu{k}\right\}$
		- $k\gets k+1$
	- **end if**
-  **end while**
## 矩阵补全问题
$$\begin{split}
min||X||_{*}\\
s.t.X_{ij}=M_{ij},(i,j) \in \Omega\\
引入等式约束的二次罚函数\\
\min||X||_{*}+\frac{\sigma}{2} \Sigma_{(i,j) \in \Omega}(X_{ij}-M_{ij})^2\\
令\sigma=\frac{1}{\mu}，则有等式形式\\
\min \mu||X||_{*}+\frac{1}{2} \Sigma_{(i,j) \in \Omega}(X_{ij}-M_{ij})^2\\
\end{split}$$
求解步骤
- 给定初值$X^0，最终参数\mu，初始参数\mu_{0}，因子\gamma \in (0,1),k\gets{0}$
- **while**$\mu_{k}\geq \mu$**do**
	- 以$X^k$为初值，$\mu=\mu_{k}$为正则化求解问题$\min \mu||X||_{*}+\frac{1}{2} \Sigma_{(i,j) \in \Omega}(X_{ij}-M_{ij})^2$，得$X^{k+{1}}$
	- **if**$\mu_{k}=\mu$**then**
		- 停止迭代，输出$X^{k+{1}}$
	- **else**
		- 更新罚因子$\mu_{k+1}=\max \left\{ \mu,\gamma \mu{k}\right\}$
		- $k\gets k+1$
	- **end if**
	- $k\gets k+1$
-  **end while**
## 增广拉格朗日法
增广拉格朗日函数：$L_{\sigma}(x,\lambda)=f(x)+\Sigma_{i \in \varepsilon}\lambda_{i}c_{i(x)}+\frac{1}{2} \sigma\Sigma_{i \in \varepsilon}c_{i}^2(x)$
解决了：二次罚函数法为了满足可行性条件，必须使$\sigma_{k}\to \infty$，而导致的子问题求解的数值困难
算法框架：
- 选取初始点$x^0$，乘子$\lambda^0$，罚因子$\sigma_{0}>0$，令罚因子更新常数$\rho>0$，约束条件违反度常数$\varepsilon>0$和精度要求$\eta_{k}>0$且令$k=0$
- **for**$k=0,1,2,\dots$**do**
	- 以$x^k$为初始点，求解$$\mathop {\min} \limits_{x}L_{\sigma_{k}}(x,\lambda^k),$$
		得到满足精度条件$$||\nabla _{x}L_{\sigma_{k}}(x,\lambda^k)||\leq \eta_{k}$$
		的解$x^{k+1}$
- **if**$||c(x^{k+1})||\leq \varepsilon$**then**
	 返回近似解$x^{k+1},\lambda^k$，终止迭代
- **end if**
- 更新乘子：$\lambda^{k+1}=\lambda^k+\sigma_{k}c(x^{k+1})$
- 更新罚因子：$\sigma_{k+1}=\rho \sigma_{k}$
- **end for**
## e.g.
写出LASSO问题的增广拉格朗日函数法$$\mathop {\min}\limits_{x \in R} \frac{1}{2} ||Ax-b||^2_{2}+\mu ||x||_{1}$$
$$\begin{split}
z=Ax\\
L(x,z,\lambda)=\frac{1}{2} ||r-b||^2_{2}+\mu||x||_{1}+\lambda^T(z-Ax)+\frac{\sigma}{2}(z-Ax)^2\\
\end{split}$$
